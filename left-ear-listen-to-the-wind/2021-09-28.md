# 2021-09-28 daily

## 23 | 分布式系统的技术栈

<http://gk.link/a/1010z>

## 构建分布式系统的核心目的

总结下文章中分布式系统的核心目的

### 大流量处理

> 说白就是提升架构的整体的性能，提高系统的冗余程度。主要技术：

- 缓存系统
  很多场合，数据量很大时，频繁处理或获取数据会消耗的大量资源。缓存的作用就是从前端到数据库每层中的，来之不易的数据存储起来，再次请求时，只需从缓存中获取，而省略处理流程及缩短访问链路，从而减少资源消耗提升响应速度。

- 负载均衡
  流量从用户->网关->应用服务器->数据库，整个链路中的每个节点都是可以横向扩展的，可以将流量均衡的打到后端的服务中。
  要实现更智能的负载均衡，其中还需要处理后端服务，服务发现、服务发现等。

- 异步调用
  异步调用也是一个提升系统性能重要的点，例如 MQ 就是将生产者的流量分发的各自的消费者队列中，其中可以将队列中的数据做持久化，异常流量的特殊处理等。
  这样可以很好的解决同步阻塞所带来的问题，但同时也要考虑实时性及服务调度的问题。

- 数据镜像和数据分区
  数据分区就是通过一定的方式（例如地域）将流量导入各自对应的区域；
  数据镜像就是为了解决分区所带来的数据同步、跨区事务处理复杂等问题的解决方案，做到区域的数据一致性。

### 关键业务保护

> 提升架构整体的稳定性，通过故障隔离、业务降级等方式保证关键业务的生产。

- 服务拆分
  目的是为了**隔离故障**和**服务模块重用**；
  需要的问题是服务调用间的依赖问题。可以理解为如果优雅的拆分服务，需要考虑因素。

- 服务冗余
  弹性伸缩及故障迁移都是去除单点故障的有效措施，此时就考虑服务发现的问题以确定服务的状态，以及弹性伸缩时数据的同步。

- 限流降级
  流量过大时，可以通过异步队列，业务降级及服务熔断拒绝一部分用户保证整个架构的可用性。

- 高可用架构
  从冗余架构的角度来保障可用性，避免单点故障。
  例如多租户隔离，灾备多活，

- 高可用运维
  从 编码 -> CI/CD -> 自动化测试 -> 灰度及生产发布 应该一条很流畅的服务发布管线。减少运维所导致的系统故障率及故障时间。

## 个人需重点关注的关键技术

- DevOps
  环境部署、CI/CD、自动化测试等 DevOps 的全流程。
  目的时为了更快、更稳定的更新服务。

- 自动化运维
  自动伸缩、故障迁移、配置管理、状态管理等一系列的自动化运维技术。

- 整体的架构监控
  应用层、中间层、基础层 三层系统的监控。
  监控的目的是为了防患于未然，将故障扼杀在摇篮中。

- 流量控制
  负载均衡、服务路由、熔断、降级、限流等、流量相关的调度、灰度发布等。

## 总结

云原生的快速发展，基础设施的维护难度和成本都大幅减低，所以目前也慢慢体会到 IaaC 及容器基础的强大之处，需要加快容器相关技术学习的脚步。

> Mark 下分布式系统的“纲”:
> ![分布式系统的“纲”](https://static001.geekbang.org/resource/image/8e/db/8e92e2dff4f66147c014f930aa678fdb.jpg?wh=2556x1006)
